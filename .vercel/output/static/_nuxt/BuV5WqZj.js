import{n as _}from"./BcwvcA4o.js";import{m as B,B as g,i as z,G as A,j as b,a9 as j,aa as x}from"#entry";function F(r,s,t){var c;let u;B(t)?u={evaluating:t}:u=t||{};const{lazy:l=!1,flush:v="pre",evaluating:e=void 0,shallow:n=!0,onError:a=(c=globalThis.reportError)!=null?c:_}=u,o=g(!l),d=n?g(s):z(s);let f=0;return A(async w=>{if(!o.value)return;f++;const h=f;let m=!1;e&&Promise.resolve().then(()=>{e.value=!0});try{const p=await r(E=>{w(()=>{e&&(e.value=!1),m||E()})});h===f&&(d.value=p)}catch(p){a(p)}finally{e&&h===f&&(e.value=!1),m=!0}},{flush:v}),l?b(()=>(o.value=!0,d.value)):d}function G(r){var s;const t=j(r);return(s=t?.$el)!=null?s:t}const i=new Map;function M(r){const s=x();function t(e){var n;const a=i.get(r)||new Set;a.add(e),i.set(r,a);const o=()=>u(e);return(n=s?.cleanups)==null||n.push(o),o}function c(e){function n(...a){u(n),e(...a)}return t(n)}function u(e){const n=i.get(r);n&&(n.delete(e),n.size||l())}function l(){i.delete(r)}function v(e,n){var a;(a=i.get(r))==null||a.forEach(o=>o(e,n))}return{on:t,once:c,off:u,emit:v,reset:l}}export{M as a,F as c,G as u};
